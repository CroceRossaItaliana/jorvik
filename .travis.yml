language: python
sudo: false
dist: trusty

python:
- '3.4'
- '3.5'
- '3.6'

addons:
  postgresql: "9.5"
  apt:
    packages:
      - postgresql-9.5-postgis-2.3

env:
  global:
    - PYTHONWARNINGS=ignore
    - ENABLE_TEST_APPS=1

cache: pip

before_script:
- psql -U postgres -c 'CREATE DATABASE test_jorvik;'
- psql -U postgres -c "CREATE EXTENSION postgis" -d test_jorvik
- psql -U postgres -c "CREATE EXTENSION postgis_topology" -d test_jorvik
- pg_restore -O -d test_jorvik ./base/test_jorvik.pgsql
- mkdir -p ../log

install:
- pip install -U pip wheel
- pip install -r requirements.txt

script:
- python ./manage.py test -k -v 3 --parallel 4
