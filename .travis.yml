language: python
python:
- '3.4'
- '3.5'
addons:
  postgresql: '9.4'
cache:
  directories:
    - $HOME/.cache/pip
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- sleep 3
- psql -U postgres -c 'CREATE DATABASE test_jorvik;'
- psql -U postgres -c "CREATE EXTENSION postgis" -d test_jorvik
- psql -U postgres -c "CREATE EXTENSION postgis_topology" -d test_jorvik
- pg_restore -O -d test_jorvik ./base/test_jorvik.pgsql
install:
- pip install -U pip wheel
- pip install -r requirements.txt
script:
- python ./manage.py test -k -v 3 --parallel 2
env:
  global:
  - secure: j6SGk3f+JsQGcWeyAstHZ/68/CgKjHz90bM9LQEyqcZXU/t6JrVM2wbxLAcixhrWsMpeIvoYUsrdZd8WFurDn7lOPe8B6s70WAQc2ZR9Ehhvt4fWtZghMPF2aP7BDGsjtq3eldb+aDTY1cFEf7A7sjBep5UmOuvKHWFVslnGLtQ=
  - secure: JGn+Js9aeQE/6tTX5ZKWOgvvBhxgWrFinjobKzGJO/msPuxQ/8Q/q3LzvTA1rHET96PJ0vqAt9RTSI1r0qbftc7kvL3O6QnrMKu6X0+aG4drRmVCLEBJ9GOWuCFrfQLrZhU6WyfnlnyqEfupbE8QMTJhGOZFHg4/7W+AeR/CpmE=
  - secure: Y8LjVIeb0wRAYuKuGuHXruGHLfnScb2Ax9qkrDAgKs8Hn61EHHZjD7q+e4qGHXEYz24qnBV55bpSNT8aYNjtVUEWlCHTk5iMWakXsJ63kNxvWhV33/dD9vuIHf5hCnq1g0lqig7Q7AnVUJLqDWLU4JmlceL8MPdEvDwi1PCH6BQ=
